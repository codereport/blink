<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blink Technical Stock Analysis</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns@3.0.0"></script>
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <div class="container">
        <div class="header">
            <div class="input-section">
                <input type="text" id="ticker-input" placeholder="Enter Ticker (e.g., AAPL)" value="NVDA">
                <button id="load-button">Load Data</button>
                <button id="update-button">Update Data</button>
                <button id="update-all-button">Update All</button>
            </div>
            <div class="time-window-controls">
                <button id="btn-3m" class="time-btn" data-window="3m">3 Months (1)</button>
                <button id="btn-6m" class="time-btn active" data-window="6m">6 Months (2)</button>
                <button id="btn-1y" class="time-btn" data-window="1y">1 Year (3)</button>
                <button id="btn-5y" class="time-btn" data-window="5y">5 Years (4)</button>
            </div>
        </div>

        <div class="main-content">
            <div class="expression-sidebar">
                <div class="expression-list">
                    <!-- Expression items will be loaded dynamically -->
                </div>
            </div>

            <div class="chart-container">
                <div class="price-chart-wrapper">
                    <canvas id="price-chart"></canvas>
                </div>
                <div class="expression-result-wrapper">
                    <canvas id="expression-result-chart"></canvas>
                </div>
                <div class="volume-chart-wrapper">
                    <canvas id="volume-chart"></canvas>
                </div>
            </div>

            <div class="ticker-sidebar">
                <div class="ticker-list">
                    <!-- Ticker items will be loaded dynamically -->
                </div>
            </div>
        </div>

        <div class="status-bar">
            <span id="status-text">Date: | Daily % Gain/Loss: % | 6M Total: % | Volume: | Open: | High: | Low: | Close:
            </span>
        </div>

    </div>

    <!-- Help Popup -->
    <div id="help-popup" class="help-popup hidden">
        <div class="help-content">
            <div class="help-header">
                <h3>üìä Blink Technical Stock Analysis - Controls</h3>
                <span class="help-close">&times;</span>
            </div>
            <div class="help-body">
                <div class="help-column">
                    <div class="help-section">
                        <h4>‚å®Ô∏è General</h4>
                        <div class="help-grid">
                            <div class="shortcut"><kbd>F</kbd><span>Toggle Fullscreen</span></div>
                            <div class="shortcut"><kbd>Space</kbd><span>New Ticker Input</span></div>
                            <div class="shortcut"><kbd>H</kbd><span>Toggle This Help</span></div>
                            <div class="shortcut"><kbd>I</kbd><span>Toggle Company Info</span></div>
                            <div class="shortcut"><kbd>T</kbd><span>Toggle Technical Indicators</span></div>
                            <div class="shortcut"><kbd>B</kbd><span>Toggle Blue Line Mode</span></div>
                            <div class="shortcut"><kbd>M</kbd><span>Toggle Market Overlay (SPY)</span></div>
                            <div class="shortcut"><kbd>Esc</kbd><span>Cancel Zoom / Reset Zoom</span></div>
                            <div class="shortcut"><kbd>1-4</kbd><span>Time Windows (3M, 6M, 1Y, 5Y)</span></div>
                            <div class="shortcut"><kbd>‚Üë‚Üì</kbd><span>Navigate Ticker List</span></div>
                            <div class="shortcut"><kbd>Ctrl+Enter</kbd><span>Update Current Ticker Data</span></div>
                            <div class="shortcut"><kbd>Ctrl+Shift+Enter</kbd><span>Update All Ticker Data</span></div>
                        </div>
                    </div>
                </div>
                <div class="help-column">
                    <div class="help-section">
                        <h4>üîß DSL Specific</h4>
                        <div class="help-grid">
                            <div class="shortcut"><kbd>/</kbd><span>Open Blink DSL Input</span></div>
                            <div class="shortcut"><kbd>Shift+/</kbd><span>Add Prefix to Current Expr</span></div>
                            <div class="shortcut"><kbd>Ctrl+Enter</kbd><span>Translate Keywords</span></div>
                            <div class="shortcut"><kbd>Enter</kbd><span>Execute Expression</span></div>
                            <div class="shortcut"><kbd>‚Üê‚Üí</kbd><span>Navigate Expression List</span></div>
                            <div class="shortcut"><kbd>S</kbd><span>Screen Stocks by Expression</span></div>
                            <div class="shortcut"><kbd>Ctrl+S</kbd><span>Screen Stocks via CUDA</span></div>
                            <div class="shortcut"><kbd>R</kbd><span>Reset Ticker List</span></div>
                            <div class="shortcut"><kbd>D</kbd><span>Delete Current Expression</span></div>
                            <div class="shortcut"><kbd>E</kbd><span>Edit Current Expression</span></div>
                        </div>
                    </div>
                    <div class="help-section">
                        <h4>üñ±Ô∏è Mouse Controls</h4>
                        <div class="help-grid">
                            <div class="shortcut"><span>Mouse Move</span><span>Show crosshairs and data</span></div>
                            <div class="shortcut"><span>First Click</span><span>Start zoom range selection</span></div>
                            <div class="shortcut"><span>Second Click</span><span>Complete zoom to selected range</span></div>
                        </div>
                    </div>
                </div>
                <div class="help-column">
                    <div class="help-section">
                        <h4>üìà Chart Features</h4>
                        <ul>
                            <li><strong>Click Zoom:</strong> Click twice on chart to zoom into a specific time range</li>
                            <li><strong>Zoom Reset:</strong> Press Esc to cancel zoom selection or reset to original view</li>
                            <li><strong>Technical Indicators:</strong> SMA (10, 20, 50), Bollinger Bands</li>
                            <li><strong>Market Overlay:</strong> Compare with SPY performance</li>
                            <li><strong>Real-time Crosshairs:</strong> Hover to see precise values</li>
                            <li><strong>Volume Chart:</strong> Trading volume visualization</li>
                            <li><strong>Expression Results:</strong> DSL expressions shown as charts or values</li>
                            <li><strong>Expression List:</strong> Left sidebar shows all executed expressions</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Blink DSL Input Popup -->
    <div id="dsl-popup" class="dsl-popup hidden">
        <div id="dsl-input" class="dsl-input" contenteditable="true" spellcheck="false" data-placeholder="Enter expression..."></div>
        <div id="dsl-result" class="dsl-result hidden"></div>
    </div>

    <!-- Company Info Popup -->
    <div id="company-info-popup" class="company-info-popup hidden">
        <div class="company-info-content">
            <div class="company-info-header">
                <h3>üè¢ Company Info</h3>
                <span class="company-info-close">&times;</span>
            </div>
            <div class="company-info-body">
                <!-- Content loaded dynamically -->
            </div>
        </div>
    </div>

    <script src="technical-indicators.js"></script>
    <script src="simple-candlestick.js"></script>
    <script src="app.js"></script>
</body>

</html>